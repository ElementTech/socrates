<!--<c-header class="mb-4 d-print-none" position="sticky">-->



<ng-container>
  <c-container [fluid]="true">
    <button
      toggle="visible"
      cHeaderToggler
      [cSidebarToggle]="sidebarId"
      class="ps-1"
    >
      <svg cIcon
        name="cilMenu"
        size="lg"
      ></svg>
    </button>


    <div class="menu d-lg-flex me-auto">
      <a routerLink="/portal" routerLinkActive="focus" class="link">
        <span class="link-icon">
          <!-- icon -->
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-door-open" viewBox="0 0 16 16">
            <path d="M8.5 10c-.276 0-.5-.448-.5-1s.224-1 .5-1 .5.448.5 1-.224 1-.5 1z"/>
            <path d="M10.828.122A.5.5 0 0 1 11 .5V1h.5A1.5 1.5 0 0 1 13 2.5V15h1.5a.5.5 0 0 1 0 1h-13a.5.5 0 0 1 0-1H3V1.5a.5.5 0 0 1 .43-.495l7-1a.5.5 0 0 1 .398.117zM11.5 2H11v13h1V2.5a.5.5 0 0 0-.5-.5zM4 1.934V15h6V1.077l-6 .857z"/>
          </svg>
          <!-- /icon -->
        </span>
        <span class="link-title">Portal</span>
      </a>
      <a routerLink="/settings/users" routerLinkActive="focus" class="link">
        <span class="link-icon">
          <!-- icon -->
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-people" viewBox="0 0 16 16">
            <path d="M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1h8zm-7.978-1A.261.261 0 0 1 7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002a.274.274 0 0 1-.014.002H7.022zM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0zM6.936 9.28a5.88 5.88 0 0 0-1.23-.247A7.35 7.35 0 0 0 5 9c-4 0-5 3-5 4 0 .667.333 1 1 1h4.216A2.238 2.238 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816zM4.92 10A5.493 5.493 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275zM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0zm3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4z"/>
          </svg>
          <!-- /icon -->
        </span>
        <span class="link-title">Users</span>
      </a>
      <a routerLink="/settings/configure" routerLinkActive="focus" class="link">
        <span class="link-icon">
          <!-- icon -->
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-gear" viewBox="0 0 16 16">
            <path d="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z"/>
            <path d="M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115l.094-.319z"/>
          </svg>
          <!-- /icon -->
        </span>
        <span class="link-title">Settings</span>
      </a>
    
      <a routerLink="/settings/github" routerLinkActive="focus" class="link">
        <span class="link-icon">
          <!-- icon -->
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-github" viewBox="0 0 16 16">
            <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
          </svg>
          <!-- /icon -->
        </span>
        <span class="link-title">Github</span>
      </a>
    </div>


    <!-- <c-nav variant="pills" class="d-none d-lg-flex me-auto">
      <c-nav-item>
        <a cNavLink routerLink="/portal" routerLinkActive="active">
         <i class="fa fa-dungeon" aria-hidden="true"></i> Portal
        </a>
      </c-nav-item>
      <c-nav-item>
        <a cNavLink routerLink="/settings/users" routerLinkActive="active">
         <i class="fa fa-users" aria-hidden="true"></i> Users</a>
      </c-nav-item>
      <c-nav-item>
        <a cNavLink routerLink="/settings/settings" routerLinkActive="active">
         <i class="fa fa-cog" aria-hidden="true"></i> Settings
        </a>
      </c-nav-item>
      <c-nav-item>
        <a cNavLink routerLink="/settings/github" routerLinkActive="active">
         <i class="fa fa-github" aria-hidden="true"></i> Github
        </a>
      </c-nav-item>      
    </c-nav> -->

    <c-header-nav class="d-none d-lg-flex">
      <c-nav-item>
        <a (click)="toDocs()" cNavLink>
          <svg cIcon name="cilShortText" size="lg"></svg>
          API
        </a>
      </c-nav-item>
      <c-nav-item>
        <a routerLink="/storage" cNavLink>
          <svg cIcon name="cilStorage" size="lg"></svg>
          Storage
        </a>
      </c-nav-item>
    
    </c-header-nav>
    <c-header-nav class="ms-3">
      <ng-container *ngTemplateOutlet="userDropdown"></ng-container>

      <button pButton type="text" class="p-button-outlined p-button-sm text-dark" (click)="display = !display;refreshSidebar()" icon="pi pi-backward" label="Runs"></button>
      <p-sidebar 
      (onHide)="hideSidebar()"
      [style]="{width:'23em'}"
      [modal]="true"
      [showCloseIcon]="true"
      [modal]="false"
      [(visible)]="display" position="right" appendTo="body" >
      <!-- [].concat([{name:'all'}]).concat() -->
      <div class="d-flex">
        <p-dropdown (onChange)="onUserFilter($event)"
        placeholder="Filter by User"
        autoWidth="false" [style]="{'width':'100%'}"
        [filter]="true" filterBy="name" [showClear]="true" optionValue="name"
        [options]="allUsers | async" [(ngModel)]="userFilter" optionLabel="name"></p-dropdown>
        <p-dropdown (onChange)="onTypeFilter($event)"
        placeholder="Filter by Type"
        autoWidth="false" [style]="{'width':'100%'}"
        [filter]="true" filterBy="name" [showClear]="true" optionValue="name"
        [options]="[{name:'instance'},{name:'step'},{name:'dag'}]" [(ngModel)]="typeFilter" optionLabel="name"></p-dropdown>
      </div>

      <mat-list class="infinitelist" style="padding:0 !important;">
          <ng-container *ngFor="let item of all_runs">
            <mat-divider></mat-divider>
              <mat-list-item 
              [routerLink]="[]"
              class="listitem" [style.border-left]="getBorder(item.done,item.error)">
              
              <p matLine class="text-center"  style="background-color:lightgrey"> 
                  <small>{{item.name}}</small>
              </p>
              <h3 matLine> 
                <p-progressSpinner
                [style]="{width: '20px', height: '20px'}"
                *ngIf="!item.done"></p-progressSpinner>
            
                <small style="font-size:10px"> &nbsp;ID: {{item._id}}</small> </h3>
                <p matLine><small style="font-size:10px"> Triggered By: {{item.user || "socrates"}}</small></p>
              <p matLine>
                
                  <span> <i class="fa fa-clock-o" aria-hidden="true"></i>&nbsp;Duration: <code>{{getRuntime(item.runtime)}}</code>
                    <br>
                    <i class="fa fa-calendar-o" aria-hidden="true"></i>&nbsp;Created: <code>{{item.createdAt | date:'short'}}</code>
                    <!-- <mat-chip-list class="artlist" *ngIf="item.artifacts.length != 0" >
                      <mat-chip style="min-height: 22px !important; cursor: pointer;">Artifacts: {{item.artifacts.length}}</mat-chip>
                      [routerLink]="['/instance/artifacts/', this.id , item.id]"
                    </mat-chip-list>  -->
                </span>
                  
              </p>
              <button 
              (click)="this.redirectTo('/'+item.type+'/run/'+item.component+'/'+item._id);"
                pButton pRipple class="p-button-sm p-button-outlined">
                <i *ngIf="item.type == 'instance'" class="fa fa-cubes" aria-hidden="true"></i>
                <i *ngIf="item.type == 'step'" class="fa fa-stairs" aria-hidden="true"></i>
                <i *ngIf="item.type == 'dag'" class="fa fa-sitemap" aria-hidden="true"></i>
              </button>
              <!-- <button mat-icon-button [matMenuTriggerFor]="itemMenu" [matMenuTriggerData]="{name: item.id, instance:this.id,docker:item.id,length:item.artifacts.length}">
                  <mat-icon>
                  more_vert
                  </mat-icon>
              </button> -->
              <mat-divider></mat-divider>
              </mat-list-item>
          </ng-container>
      </mat-list>
    
        <!-- <p-orderList 
          [value]="all_runs | async" 
          [listStyle]="{'max-height':'30rem'}" 
          header="List of Runs" 
          filterBy="type" 
          filterPlaceholder="Filter by type" 
          [dragdrop]="false"
        >
            <ng-template let-run pTemplate="item">
                <div class="run-item">
                    <div class="run-list-detail">
                        <h5 class="mb-2">{{run._id}}</h5>
                        <i class="pi pi-tag run-category-icon"></i>
                        <span class="run-category">{{run.done}}</span>
                    </div>
                    <div class="run-list-action">
                        <h6 class="mb-2">${{run.type}}</h6>
                    </div>
                </div>
            </ng-template>
        </p-orderList> -->
    
      </p-sidebar>
    </c-header-nav>

  </c-container>
  <c-header-divider></c-header-divider>
  <c-container [fluid]="true">
    <!-- <c-breadcrumb-router class="ms-2"></c-breadcrumb-router> -->
    <xng-breadcrumb>
      <ng-container
      *xngBreadcrumbItem="let breadcrumb; let info = info; let first = first"
    >
    <div *ngIf="info">
      <i class="fa fa-{{ info }}" aria-hidden="true"></i>
      &nbsp;
    </div>
      <ng-container *ngIf="!first">{{ breadcrumb.replaceAll("/"," / ") }}</ng-container>
    </ng-container>
    </xng-breadcrumb>
  </c-container>
</ng-container>
<!--</c-header>-->

<ng-template #userDropdown>
  <c-dropdown alignment="end" variant="nav-item">
    <button
      cButton
      color=""
      [caret]="false"
      cDropdownToggle
      class="py-0"
    >
      <c-avatar
        cTextColor="primary"
        shape="rounded-1"
        size="md"
        src="../../../../assets/abstract-user-flat-4.png"
        status="success"
      >
      </c-avatar>
    </button>
    <ul cDropdownMenu class="pt-0 w-auto">
      <li>
        <h6 cDropdownHeader class="bg-light fw-semibold py-2">Account</h6>
      </li>
      <li>
        <a routerLink="/profile" cDropdownItem>
          <svg cIcon class="me-2" name="cilUser"></svg>
          Profile
        </a>
      </li>
      <li>
        <hr cDropdownDivider/>
      </li>
      <li>
        <a (click)="logout()" cDropdownItem>
          <svg cIcon class="me-2" name="cilLockLocked"></svg>
          Logout
        </a>
      </li>
      <li></li>
    </ul>
  </c-dropdown>
</ng-template>

